# UC-3.1 每日一次抽取卡牌

| 項目 | 內容 |
|------|------|
| **填表人** | 李芝瑢 |
| **商業流程編號** | UC-3.1 |
| **行為者** | 會員 |
| **內容概述** | 使用者每日可抽取一次占卜卡牌(如塔羅牌、每日運勢卡等),獲得隨機卡片與解讀內容,增加趣味性與每日互動。 |
| **先決條件** | 使用者已登入,且當日尚未抽卡(依 UTC+8 時區計算,每日 00:00 重置)。 |
| **後置條件** | 系統隨機產生一張卡片,抽卡結果記錄至 card_draws 資料表,使用者可查看卡片內容與解讀。 |
| **主要流程** | 1. 使用者進入「每日抽卡」頁面。<br>2. 系統檢查該用戶當日是否已抽卡(查詢 card_draws 表中 DATE(drawn_at) = CURDATE() 的記錄)。<br>3. 若未抽卡,顯示「抽卡」按鈕;若已抽卡,顯示當日已抽取的卡片。<br>4. 使用者點擊「抽卡」按鈕,系統執行抽卡動畫效果。<br>5. 系統從 cards 資料表隨機選取一張卡片(SELECT * FROM cards ORDER BY RAND() LIMIT 1)。<br>6. 系統將抽卡結果插入 card_draws 表,記錄 user_id, card_id, drawn_at。<br>7. 系統顯示卡片圖片、名稱、類型與解讀內容。<br>8. 使用者可點擊「查看詳細解讀」或「分享卡片」。 |
| **替代流程** | a. 若當日已抽卡  系統直接顯示今日已抽取的卡片,並提示「今日已抽卡,明天再來!」,不顯示抽卡按鈕。<br>b. 若卡片資料表為空  系統顯示「卡片資料載入中,請稍後再試」錯誤訊息。<br>c. 若使用者在午夜前後抽卡(跨日邊界情況)  系統依伺服器時間(UTC+8)嚴格判斷,確保每日限一次。 |
| **輔助說明** | 每日抽卡限制依伺服器時區(UTC+8)計算,每日 00:00 自動重置。抽卡結果永久保存於 card_draws 表,使用者可查看歷史抽卡記錄。卡片類型可包含:塔羅牌(Major Arcana 22 張)、每日運勢、心靈小語等。支援分享功能(UC-3.3)。 |
| **Screen 畫面** | 每日抽卡頁、抽卡結果頁、歷史抽卡記錄頁 |

---

[ 回到索引](../README.md)
